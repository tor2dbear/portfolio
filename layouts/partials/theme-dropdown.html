<div class="theme-dropdown">
  <button
    class="theme-toggle"
    aria-label="{{ i18n "Settings" }}"
    aria-expanded="false"
    aria-haspopup="true"
    data-js="theme-toggle"
  >
    <span class="theme-icon" data-js="theme-icon">
      <script>
        // Pre-render the correct icon to avoid flash
        (function() {
          const mode = localStorage.getItem('theme-mode') || 'system';
          const iconId = mode === 'light' ? 'icon-light' : mode === 'dark' ? 'icon-dark' : 'icon-system';
          document.write('<svg width="24" height="24" aria-hidden="true"><use href="{{ "/img/svg/sprite.svg" | relURL }}#' + iconId + '"></use></svg>');
        })();
      </script>
      <noscript>
        <svg width="24" height="24" aria-hidden="true">
          <use href="{{ "/img/svg/sprite.svg" | relURL }}#icon-system"></use>
        </svg>
      </noscript>
    </span>
  </button>

  <div class="theme-overlay" hidden data-js="theme-overlay"></div>

  <div class="theme-panel" hidden data-js="theme-panel">
    <div class="theme-section">
      <h3 class="theme-section-title">{{ i18n "mode" }}</h3>
      <div class="theme-options">
        <button
          class="theme-option"
          data-mode="light"
          data-js="mode-option"
          aria-label="{{ i18n "light_mode" }}"
        >
          <svg class="theme-option-icon" width="20" height="20" aria-hidden="true">
            <use href="{{ "/img/svg/sprite.svg" | relURL }}#icon-light"></use>
          </svg>
          <span>{{ i18n "light_mode" }}</span>
        </button>

        <button
          class="theme-option"
          data-mode="dark"
          data-js="mode-option"
          aria-label="{{ i18n "dark_mode" }}"
        >
          <svg class="theme-option-icon" width="20" height="20" aria-hidden="true">
            <use href="{{ "/img/svg/sprite.svg" | relURL }}#icon-dark"></use>
          </svg>
          <span>{{ i18n "dark_mode" }}</span>
        </button>

        <button
          class="theme-option"
          data-mode="system"
          data-js="mode-option"
          aria-label="{{ i18n "system_mode" }}"
        >
          <svg class="theme-option-icon" width="20" height="20" aria-hidden="true">
            <use href="{{ "/img/svg/sprite.svg" | relURL }}#icon-system"></use>
          </svg>
          <span>{{ i18n "system_mode" }}</span>
        </button>
      </div>
    </div>

    <div class="theme-divider"></div>

    <div class="theme-section">
      <h3 class="theme-section-title">{{ i18n "palette" }}</h3>
      <div class="theme-options theme-options--palette">
        <button
          class="theme-option theme-option--palette"
          data-palette="standard"
          data-js="palette-option"
          aria-label="Standard"
        >
          <span class="palette-preview palette-preview--standard">
            <span class="palette-preview-segment"></span>
            <span class="palette-preview-segment"></span>
          </span>
          <span class="palette-label">Standard</span>
        </button>

        <button
          class="theme-option theme-option--palette"
          data-palette="forest"
          data-js="palette-option"
          aria-label="Forest"
        >
          <span class="palette-preview palette-preview--forest">
            <span class="palette-preview-segment"></span>
            <span class="palette-preview-segment"></span>
          </span>
          <span class="palette-label">Forest</span>
        </button>

        <button
          class="theme-option theme-option--palette"
          data-palette="mesa"
          data-js="palette-option"
          aria-label="Mesa"
        >
          <span class="palette-preview palette-preview--mesa">
            <span class="palette-preview-segment"></span>
            <span class="palette-preview-segment"></span>
          </span>
          <span class="palette-label">Mesa</span>
        </button>

        <button
          class="theme-option theme-option--palette"
          data-palette="pantone"
          data-js="palette-option"
          aria-label="Pantone"
        >
          <span class="palette-preview palette-preview--pantone">
            <span class="palette-preview-segment"></span>
            <span class="palette-preview-segment"></span>
          </span>
          <span class="palette-label">Pantone</span>
        </button>

      </div>
    </div>

    <div class="theme-divider"></div>

    <div class="theme-section">
      <h3 class="theme-section-title">{{ i18n "typography" }}</h3>
      <div class="theme-options theme-options--typography">
        <button
          class="theme-option theme-option--typography"
          data-typography="editorial"
          data-js="typography-option"
          aria-label="Editorial"
        >
          <span class="typography-preview">Aa</span>
          <span class="typography-label">Editorial</span>
        </button>

        <button
          class="theme-option theme-option--typography"
          data-typography="refined"
          data-js="typography-option"
          aria-label="Refined"
        >
          <span class="typography-preview typography-preview--refined">Aa</span>
          <span class="typography-label">Refined</span>
        </button>

        <button
          class="theme-option theme-option--typography"
          data-typography="expressive"
          data-js="typography-option"
          aria-label="Expressive"
        >
          <span class="typography-preview typography-preview--expressive">Aa</span>
          <span class="typography-label">Expressive</span>
        </button>

        <button
          class="theme-option theme-option--typography"
          data-typography="technical"
          data-js="typography-option"
          aria-label="Technical"
        >
          <span class="typography-preview typography-preview--technical">Aa</span>
          <span class="typography-label">Technical</span>
        </button>

        <button
          class="theme-option theme-option--typography"
          data-typography="system"
          data-js="typography-option"
          aria-label="System"
        >
          <span class="typography-preview typography-preview--system">Aa</span>
          <span class="typography-label">System</span>
        </button>
      </div>
    </div>

    <div class="theme-divider"></div>

    <div class="theme-section">
      <h3 class="theme-section-title">Grid</h3>
      <button
        class="toggle-switch"
        data-js="grid-toggle"
        role="switch"
        aria-pressed="false"
        aria-label="Toggle grid overlay"
      >
        <span class="toggle-switch__track">
          <span class="toggle-switch__thumb"></span>
        </span>
        <span class="toggle-switch__label">Show grid</span>
        <span class="toggle-switch__shortcut">Ctrl+G</span>
      </button>
    </div>
  </div>
</div>
