<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta
    name="description"
    content="{{ if .IsNode }}
      {{ with .Site.Params.description }}{{ . }}{{ end }}
    {{ else }}
      {{ with .Description }}{{ . }}{{ end }}
    {{ end }}"
  />
  <meta
    name="theme-color"
    content="#FFFFFF"
    media="(prefers-color-scheme: light)"
  />
  <meta
    name="theme-color"
    content="#18181b"
    media="(prefers-color-scheme: dark)"
  />
  <script>
    (function () {
      try {
        var doc = document.documentElement;
        var scrollTop =
          window.pageYOffset ||
          document.documentElement.scrollTop ||
          document.body.scrollTop ||
          0;
        var height =
          document.documentElement.scrollHeight -
          document.documentElement.clientHeight;
        var progress = height > 0 ? scrollTop / height : 0;
        if (progress < 0) progress = 0;
        if (progress > 1) progress = 1;
        doc.style.setProperty("--brand-progress", progress);
      } catch (e) {}
    })();
  </script>
  {{ if eq .Params.index false }}
    <meta name="robots" content="noindex" />
  {{ end }}

  <!-- Google Search Console verification -->
  <meta name="google-site-verification" content="7a1qvb7XC4NVOarpiAgYDg7pnCgz4Gg3GKFvfFk6_Ls" />

  {{ hugo.Generator }}


  <title>
    {{ if .IsHome }}
      {{ .Site.Params.title }}
    {{ else }}
      {{ .Title }} &middot; {{ .Site.Params.title }}
    {{ end }}
  </title>

  {{ if .Params.canonical }}
    <link rel="canonical" href="{{ .Params.canonical }}" />
  {{ else }}
    {{/* Auto-generate canonical URL without query params for SEO */}}
    <link rel="canonical" href="{{ .Permalink }}" />
  {{ end }}

  {{/* Hreflang tags for multilingual SEO */}}
  {{ range .AllTranslations }}
    <link rel="alternate" hreflang="{{ .Language.Lang }}" href="{{ .Permalink }}" />
  {{ end }}
  {{ range .AllTranslations }}
    {{ if eq .Language.Lang "en" }}
      <link rel="alternate" hreflang="x-default" href="{{ .Permalink }}" />
    {{ end }}
  {{ end }}

  <!-- CSS base (reset) -->
  {{ $base_reset := resources.Get "css/base/reset.css" }}

  <!-- CSS tokens (3-layer architecture) -->
  {{ $tokens_primitives := resources.Get "css/tokens/primitives.css" }}
  {{ $tokens_semantic := resources.Get "css/tokens/semantic.css" }}
  {{ $tokens_components := resources.Get "css/tokens/components.css" }}

  <!-- CSS dimensions (mode + palette) -->
  {{ $dimensions_mode_light := resources.Get "css/dimensions/mode/light.css" }}
  {{ $dimensions_mode_dark := resources.Get "css/dimensions/mode/dark.css" }}
  {{ $dimensions_palette_standard := resources.Get "css/dimensions/palette/standard.css" }}
  {{ $dimensions_palette_forest := resources.Get "css/dimensions/palette/forest.css" }}
  {{ $dimensions_palette_mesa := resources.Get "css/dimensions/palette/mesa.css" }}
  {{ $dimensions_palette_pantone := resources.Get "css/dimensions/palette/pantone.css" }}
  {{ $dimensions_palette_previews := resources.Get "css/dimensions/palette/previews.css" }}

  <!-- CSS utilities -->
  {{ $utilities_typography := resources.Get "css/utilities/typography.css" }}
  {{ $utilities_layout := resources.Get "css/utilities/layout.css" }}
  {{ $utilities_grid := resources.Get "css/utilities/grid.css" }}
  {{ $utilities_display := resources.Get "css/utilities/display.css" }}
  {{ $utilities_icons := resources.Get "css/utilities/icons.css" }}

  <!-- CSS components (NEW - redesign) -->
  {{ $components_button := resources.Get "css/components/button.css" }}
  {{ $components_form := resources.Get "css/components/form.css" }}
  {{ $components_footer := resources.Get "css/components/footer.css" }}
  {{ $components_theme_dropdown := resources.Get "css/components/theme-dropdown.css" }}
  {{ $components_language_dropdown := resources.Get "css/components/language-dropdown.css" }}
  {{ $components_settings_dropdown := resources.Get "css/components/settings-dropdown.css" }}
  {{ $components_article_card := resources.Get "css/components/article-card.css" }}
  {{ $components_navigation := resources.Get "css/components/navigation.css" }}
  {{ $components_pagination := resources.Get "css/components/pagination.css" }}
  {{ $components_breadcrumb := resources.Get "css/components/breadcrumb.css" }}
  {{ $components_tags := resources.Get "css/components/tags.css" }}
  {{ $components_newsletter := resources.Get "css/components/newsletter.css" }}
  {{ $components_tooltip := resources.Get "css/components/tooltip.css" }}
  {{ $components_download_card := resources.Get "css/components/download-card.css" }}
  {{ $components_table_of_contents := resources.Get "css/components/table-of-contents.css" }}
  {{ $components_gallery := resources.Get "css/components/gallery.css" }}

  <!-- CSS pages (NEW - redesign) -->
  {{ $pages_home := resources.Get "css/pages/home.css" }}
  {{ $pages_ui_library := resources.Get "css/pages/ui-library.css" }}

  <!-- CSS main styles -->
  {{ $style := resources.Get "css/style.css" }}
  {{ $print := resources.Get "css/print.css" }}


  <!-- CSS loading -->
  {{ if eq hugo.Environment "development" }}
    <!-- CSS development -->
    <link rel="stylesheet" type="text/css" href="{{ $base_reset.RelPermalink }}" />
    <link rel="stylesheet" type="text/css" href="{{ $tokens_primitives.RelPermalink }}" />
    <link rel="stylesheet" type="text/css" href="{{ $tokens_semantic.RelPermalink }}" />
    <link rel="stylesheet" type="text/css" href="{{ $tokens_components.RelPermalink }}" />
    <link rel="stylesheet" type="text/css" href="{{ $dimensions_mode_light.RelPermalink }}" />
    <link rel="stylesheet" type="text/css" href="{{ $dimensions_mode_dark.RelPermalink }}" />
    <link rel="stylesheet" type="text/css" href="{{ $dimensions_palette_standard.RelPermalink }}" />
    <link rel="stylesheet" type="text/css" href="{{ $dimensions_palette_forest.RelPermalink }}" />
    <link rel="stylesheet" type="text/css" href="{{ $dimensions_palette_mesa.RelPermalink }}" />
    <link rel="stylesheet" type="text/css" href="{{ $dimensions_palette_pantone.RelPermalink }}" />
    <link rel="stylesheet" type="text/css" href="{{ $dimensions_palette_previews.RelPermalink }}" />
    <link rel="stylesheet" type="text/css" href="{{ $utilities_typography.RelPermalink }}" />
    <link rel="stylesheet" type="text/css" href="{{ $utilities_layout.RelPermalink }}" />
    <link rel="stylesheet" type="text/css" href="{{ $utilities_grid.RelPermalink }}" />
    <link rel="stylesheet" type="text/css" href="{{ $utilities_display.RelPermalink }}" />
    <link rel="stylesheet" type="text/css" href="{{ $utilities_icons.RelPermalink }}" />
    <link rel="stylesheet" type="text/css" href="{{ $components_button.RelPermalink }}" />
    <link rel="stylesheet" type="text/css" href="{{ $components_form.RelPermalink }}" />
    <link rel="stylesheet" type="text/css" href="{{ $components_footer.RelPermalink }}" />
    <link rel="stylesheet" type="text/css" href="{{ $components_theme_dropdown.RelPermalink }}" />
    <link rel="stylesheet" type="text/css" href="{{ $components_language_dropdown.RelPermalink }}" />
    <link rel="stylesheet" type="text/css" href="{{ $components_settings_dropdown.RelPermalink }}" />
    <link rel="stylesheet" type="text/css" href="{{ $components_article_card.RelPermalink }}" />
    <link rel="stylesheet" type="text/css" href="{{ $components_navigation.RelPermalink }}" />
    <link rel="stylesheet" type="text/css" href="{{ $components_pagination.RelPermalink }}" />
    <link rel="stylesheet" type="text/css" href="{{ $components_breadcrumb.RelPermalink }}" />
    <link rel="stylesheet" type="text/css" href="{{ $components_tags.RelPermalink }}" />
    <link rel="stylesheet" type="text/css" href="{{ $components_newsletter.RelPermalink }}" />
    <link rel="stylesheet" type="text/css" href="{{ $components_tooltip.RelPermalink }}" />
    <link rel="stylesheet" type="text/css" href="{{ $components_download_card.RelPermalink }}" />
    <link rel="stylesheet" type="text/css" href="{{ $components_table_of_contents.RelPermalink }}" />
    {{ with $components_gallery }}
      <link rel="stylesheet" type="text/css" href="{{ .RelPermalink }}" />
    {{ end }}
    <link rel="stylesheet" type="text/css" href="{{ $pages_home.RelPermalink }}" />
    <link rel="stylesheet" type="text/css" href="{{ $pages_ui_library.RelPermalink }}" />
    <link rel="stylesheet" type="text/css" href="{{ $style.RelPermalink }}" />
    <link rel="stylesheet" type="text/css" href="{{ $print.RelPermalink }}" />
  {{ else }}
    <!-- CSS production -->
    {{ $css := slice $base_reset $tokens_primitives $tokens_semantic $tokens_components $dimensions_mode_light $dimensions_mode_dark $dimensions_palette_standard $dimensions_palette_forest $dimensions_palette_mesa $dimensions_palette_pantone $dimensions_palette_previews $utilities_typography $utilities_layout $utilities_grid $utilities_display $utilities_icons $components_button $components_form $components_footer $components_theme_dropdown $components_language_dropdown $components_settings_dropdown $components_article_card $components_navigation $components_pagination $components_breadcrumb $components_tags $components_newsletter $components_tooltip $components_download_card $components_table_of_contents }}
    {{ with $components_gallery }}
      {{ $css = $css | append . }}
    {{ end }}
    {{ $css = $css | append $pages_home $pages_ui_library $style $print }}
    {{ $css = $css | resources.Concat "css.css" | minify | fingerprint }}
    <link
      rel="stylesheet"
      type="text/css"
      href="{{ $css.Permalink }}"
      integrity="{{ $css.Data.Integrity }}"
      media="all"
    />
  {{ end }}


  <!-- Dark mode -->
  <script src="{{ .Site.BaseURL }}js/darkmode-initial.js"></script>

  <!-- JavaScript resources -->
  {{/*  <script src="js/darkmode-initial.js" defer></script>
  <script src="js/ui.js" defer></script>
  <script src="js/header-line.js" defer></script>
  <script src="js/header-hide.js" defer></script>
  <script src="js/theme.js" defer></script>
  <script src="js/darkmode.js" defer></script>
  <script src="js/client-check.js" defer></script>
  <script src="js/progressbar.js" defer></script>
  {{ $mainJs := resources.Get "js/progressbar.js" | js.Build "main.js" | minify | fingerprint }}
  <script src="{{ $mainJs.RelPermalink }}" defer></script>  */}}

  <!-- JavaScript resources -->
  {{ $js1 := resources.Get "js/ui.js" }}
  {{ $js2 := resources.Get "js/header-line.js" }}
  {{ $js3 := resources.Get "js/header-hide.js" }}
  {{ $js4 := resources.Get "js/darkmode.js" }}
  {{ $js5 := resources.Get "js/language-dropdown.js" }}
  {{ $js6 := resources.Get "js/focus-mode.js" }}
  {{ $js8 := resources.Get "js/smooth-scroll.js" }}
  {{ $js9 := resources.Get "js/role-swapper.js" }}
  {{ $js10 := resources.Get "js/ui-library-tabs.js" }}
  {{ $js11 := resources.Get "js/settings-dropdown.js" }}
  {{ $js12 := resources.Get "js/reveal-on-scroll.js" }}
  {{/* NOTE: theme.js will be archived - logic moved to darkmode.js */}}

  <!-- JavaScript loading -->
  {{ if eq hugo.Environment "development" }}
    <!-- JavaScript development -->
    <script src="{{ $js1.RelPermalink }}" defer></script>
    <script src="{{ $js2.RelPermalink }}" defer></script>
    <script src="{{ $js3.RelPermalink }}" defer></script>
    <script src="{{ $js4.RelPermalink }}" defer></script>
    <script src="{{ $js5.RelPermalink }}" defer></script>
    <script src="{{ $js6.RelPermalink }}" defer></script>
    <script src="{{ $js8.RelPermalink }}" defer></script>
    <script src="{{ $js9.RelPermalink }}" defer></script>
    <script src="{{ $js10.RelPermalink }}" defer></script>
    <script src="{{ $js11.RelPermalink }}" defer></script>
    <script src="{{ $js12.RelPermalink }}" defer></script>
  {{ else }}
    <!-- JavaScript production -->
    {{ $js := slice $js1 $js2 $js3 $js4 $js5 $js6 $js8 $js9 $js10 $js11 $js12 | resources.Concat "js.js" | minify | fingerprint }}
    <script src="{{ $js.Permalink }}" defer></script>
  {{ end }}

    {{ partial "schema.html" . }}

    <!-- Adobe TypeKit -->
    <link
      rel="stylesheet"
      href="https://use.typekit.net/diz3sha.css"
      media="print"
      onload="this.media='all'"
    />
    <noscript
      ><link rel="stylesheet" href="https://use.typekit.net/diz3sha.css"
    /></noscript>

    <!-- MathJax -->
    <!-- <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> -->

    <!-- RSS -->
    {{ if .OutputFormats.Get "RSS" }}
      <link
        rel="alternate"
        type="application/rss+xml"
        title="{{ .Site.Title }}"
        href="{{ with .OutputFormats.Get "RSS" }}{{ .RelPermalink }}{{ end }}"
      />
    {{ end }}


    <!-- Highlight.js (commented out) -->
    {{/*
    {{ with .Site.Params.highlightjs }}
    <link
      rel="stylesheet"
      href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/styles/{{ . }}.min.css"
    />
    <script
      async
      src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/highlight.min.js"
    ></script>
    {{ range $.Site.Params.highlightjs_extra_languages }}
      <script
        async
        src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/languages/{{ . }}.min.js"
      ></script>
    {{ end }}
    <script>
      hljs.initHighlightingOnLoad();
    </script>
    {{ end }}
    */}}
  {{ partial "favicon.html" . }}


  <!-- Custom CSS -->
  {{ range .Site.Params.custom_css }}
    {{ if findRE "https?://" . }}
      <link rel="stylesheet" href="{{ . }}" />
    {{ else }}
      <link rel="stylesheet" href="{{ $.Site.BaseURL }}{{ . }}" />
    {{ end }}
  {{ end }}


  <!-- Custom JS -->
  {{ range .Site.Params.custom_js }}
    {{ if findRE "https?://" . }}
      <script src="{{ . }}"></script>
    {{ else }}
      <script src="{{ $.Site.BaseURL }}{{ . }}"></script>
    {{ end }}
  {{ end }}


  <!-- reCAPTCHA -->
  {{ if or (eq .RelPermalink "/contact/") (strings.Contains .RelPermalink "/clients/") (strings.Contains .RelPermalink "/sv/kontakt/") }}
    <script src="https://www.google.com/recaptcha/api.js?render=6LeDDAAqAAAAAHLkCglixFS15w54eLJyTocW4k7U"></script>
    <script src="{{ .Site.BaseURL }}js/recaptcha.js"></script>
  {{ end }}
</head>
