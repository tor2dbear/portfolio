<header id="topmenu" class="top-menu" data-js="top-menu">
  <div class="top-menu__container">
    {{ partial "brand.html" . }}
    <nav class="top-menu__nav" aria-label="{{ i18n "menu_title" }}">
      <ul class="top-menu__list">
        {{- $urltop := .RelPermalink -}}
        {{- $homeURL := "/" | relLangURL -}}
        {{- range .Site.Menus.top -}}
          {{- $nameLower := lower .Name -}}
          {{- $isContact := or (eq .Identifier "contact") (eq $nameLower "contact") (eq $nameLower "kontakt") -}}
          {{- $isAbout := or (eq .Identifier "about") (eq $nameLower "about") (eq $nameLower "om") -}}
          {{- if not $isContact -}}
            {{- $linkURL := .URL | relLangURL -}}
            {{- if $isAbout -}}
              {{- $linkURL = printf "%s#about" $homeURL -}}
            {{- end -}}
          <li class="top-menu__item top-menu__item--nav">
            <a
              class="top-menu__link {{ if eq $urltop $linkURL }}active{{ end }}"
              title="{{ .Name }}"
              href="{{ $linkURL }}"
            >{{ .Name }}</a>
          </li>
          {{- end -}}
        {{- end -}}

        {{- /* Theme dropdown (mode + palette) */ -}}
        <li class="top-menu__item top-menu__item--theme">
          {{ partial "theme-dropdown.html" . }}
        </li>

        {{- /* Language dropdown */ -}}
        <li class="top-menu__item top-menu__item--language">
          {{ partial "language-dropdown.html" . }}
        </li>

        {{- /* Settings dropdown (xs only) */ -}}
        <li class="top-menu__item top-menu__item--settings">
          {{ partial "settings-dropdown.html" . }}
        </li>

        {{- /* Contact button */ -}}
        <li class="top-menu__item top-menu__item--contact">
          <a
            class="top-menu__link top-menu__link--button"
            href="{{ printf "%s#contact" $homeURL }}"
          >
            <span class="top-menu__label top-menu__label--long">{{ i18n "contact_me" }}</span>
            <span class="top-menu__label top-menu__label--icon" aria-hidden="true">
              {{ readFile "static/img/svg/contact.svg" | safeHTML }}
            </span>
          </a>
        </li>
      </ul>
    </nav>
  </div>
  {{ $jsProgress := resources.Get "js/progressbar.js" }}
  {{ $jsProgressSrc := printf "/%s" (strings.TrimPrefix "/" $jsProgress.RelPermalink) }}
  {{ if eq hugo.Environment "development" }}
    <script src="{{ $jsProgressSrc }}"></script>
  {{ else }}
    {{ $jsProgressMin := $jsProgress | minify | fingerprint }}
    {{ $jsProgressMinSrc := printf "/%s" (strings.TrimPrefix "/" $jsProgressMin.RelPermalink) }}
    <script src="{{ $jsProgressMinSrc }}"></script>
  {{ end }}
</header>
